# Network-Intrusion-Detection-CNN

A lightweight CNN-based Network Intrusion Detection System (NIDS) that classifies traffic as **BENIGN** or **MALICIOUS** using payload-byte features.

This repo includes:

- `NIDS.py` — train + evaluate the CNN, save plots/metrics, and export a `.pt` checkpoint  
- `live_detection.py` — sniff live packets and run the model in real time (**Windows-friendly controls**)  
- `collect_data.py` — helper for collecting/formatting packet data  
- `results/` — plots + CSV outputs (generated by training)

## Repository layout

```text
Network-Intrusion-Detection-CNN/
  NIDS.py
  live_detection.py
  collect_data.py
  results/                 # output artifacts (plots + csv)
  data/                    # created by start.sh (not committed)
  model/                   # created by start.sh (not committed)
  requirements.txt         # install dependencies
  start.sh                 # creates folders + downloads required files
  README.md

## Requirements (hardware + software)

### Hardware
- **CPU-only works** (training may take longer).
- Optional: **NVIDIA GPU** for faster training/inference (requires a CUDA-enabled PyTorch build).

### Software
- **Python 3.10+**
- **PyTorch 2.6+**
- **Windows 10/11 recommended** for `live_detection.py` (it uses `msvcrt` keypress controls)

### Packet capture dependency (Windows): Npcap (required for live sniffing)
To run `live_detection.py` on Windows with Scapy:

1. Install Npcap (official installer):  
   https://npcap.com/#download
2. During installation, enable:  
   “Install Npcap in WinPcap API-compatible Mode”
3. Reboot (recommended).
4. Run your terminal as **Administrator** when sniffing.

If you don’t install Npcap, Scapy may fail to sniff packets and `live_detection.py` won’t work correctly.

---

## Install dependencies (no venv)

From the repo root:

```bash
python -m pip install --upgrade pip
python -m pip install -r requirements.txt

## Dataset (training)

This project trains on the **Payload-Byte** dataset described here:

- Dataset repo: https://github.com/Yasir-ali-farrukh/Payload-Byte

### Where to put it

To train using `NIDS.py`, the training CSV must be placed in:

/data/

By default, NIDS.py expects:

data/CICIDS-2017_preprocessed.csv

Quick start (download required files)

This repo does not commit data/ and model/.
Use start.sh to create folders and download required assets from Google Drive:

malicious_packets.csv → goes in data/
https://drive.google.com/file/d/102qs3YTnn8_rAcya4FQkIAKsRv_6w1Gn/view?usp=sharing

NIDS.pt → goes in model/
https://drive.google.com/file/d/1aQRpdTw6PhMNGKlPixJ0YI3gReGgmrm6/view?usp=sharing

Drive folder (contains both):
https://drive.google.com/drive/folders/1Ilz2jG1mAoJuplDrdR1Meb13Pnh4pcNX?usp=sharing

Run start.sh

Linux / macOS / Git Bash on Windows:

bash start.sh


After that, you should have:

data/malicious_packets.csv
model/NIDS.pt


If you are on Windows and not using Git Bash/WSL, you can still manually download the two files above and place them in data/ and model/.

Train the model (creates model checkpoint + results)

Once the dataset CSV is in data/:

python NIDS.py


Outputs:

model/NIDS.pt (checkpoint)

model/best.pt (same checkpoint copy)

results/loss_curve.png

results/roc_curve.png

results/confusion_f1.png (if enabled in your plotting code)

results/history.csv

results/test_metrics.csv

Run live detection (real-time sniffing + injection)

Windows recommended. You must run as Administrator for packet sniffing.

python live_detection.py


Controls:

Press i to inject one sample from data/malicious_packets.csv

Press q to quit

live_detection.py prints lines like:

YYYY-MM-DD HH:MM:SS | LIVE   | ... | src -> dst | TCP/UDP | Len: ...
YYYY-MM-DD HH:MM:SS | INJECT | ... | INJECT -> INJECT | TCP/UDP | Len: ...

What is “packet injection” here?

Injection does not transmit packets onto the network.
It samples a row from data/malicious_packets.csv and runs it through the model to test inference/logging behavior quickly.

Notes / common issues
“Scapy can’t sniff” / no packets

Ensure Npcap is installed with WinPcap compatibility mode enabled.

Run terminal as Administrator.

Ensure you have an active network interface and traffic.

PyTorch checkpoint warnings / load issues (PyTorch 2.6+)

PyTorch 2.6 changed torch.load default behavior for security (weights_only=True by default).
This repo’s NIDS.py uses weights_only=True to avoid warnings and improve compatibility.

If you ever save checkpoints containing non-tensor Python objects, you may need to adjust loading/saving logic.

Upstream / references

Payload-Byte dataset repo: https://github.com/Yasir-ali-farrukh/Payload-Byte

This project repo: https://github.com/Maggiebat/Network-Intrusion-Detection-CNN
